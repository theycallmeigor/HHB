{%- comment -%}
  Purchase Options Component
  Renders one-time purchase and subscribe & save buttons
  
  Parameters:
  - product: Product object
  - selected_variant: Currently selected variant
  - form_id: Form ID for the product form
{%- endcomment -%}

<div class="purchase-options" data-purchase-options>
  <div class="purchase-options__header">
    <h3 class="purchase-options__title">{{ 'products.product.purchase_options' | t | default: 'Purchase Options' }}</h3>
  </div>
  
  <div class="purchase-options__buttons" role="radiogroup" aria-label="{{ 'products.product.purchase_options' | t | default: 'Purchase Options' }}">
    {%- comment -%} One-time purchase option {%- endcomment -%}
    <div class="purchase-option purchase-option--onetime" data-purchase-option="onetime">
      <input 
        type="radio" 
        name="purchase_option" 
        id="purchase-onetime-{{ section.id }}"
        value="onetime"
        class="purchase-option__input visually-hidden"
        checked
        data-purchase-option-input
      >
      <label for="purchase-onetime-{{ section.id }}" class="purchase-option__label">
        <span class="purchase-option__button">
          <span class="purchase-option__icon">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
              <circle cx="10" cy="10" r="9" stroke="currentColor" stroke-width="2"/>
              <circle cx="10" cy="10" r="4" fill="currentColor" class="purchase-option__check"/>
            </svg>
          </span>
          <span class="purchase-option__content">
            <span class="purchase-option__title">{{ 'products.product.one_time_purchase' | t | default: 'One-time purchase' }}</span>
            <span class="purchase-option__price" data-onetime-price>
              {%- if selected_variant -%}
                {{ selected_variant.price | money }}
              {%- else -%}
                {{ product.price | money }}
              {%- endif -%}
            </span>
          </span>
        </span>
      </label>
    </div>

    {%- comment -%} Subscribe & Save option {%- endcomment -%}
    <div class="purchase-option purchase-option--subscribe" data-purchase-option="subscribe">
      <input 
        type="radio" 
        name="purchase_option" 
        id="purchase-subscribe-{{ section.id }}"
        value="subscribe"
        class="purchase-option__input visually-hidden"
        data-purchase-option-input
      >
      <label for="purchase-subscribe-{{ section.id }}" class="purchase-option__label">
        <span class="purchase-option__button">
          <span class="purchase-option__icon">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
              <circle cx="10" cy="10" r="9" stroke="currentColor" stroke-width="2"/>
              <circle cx="10" cy="10" r="4" fill="currentColor" class="purchase-option__check"/>
            </svg>
          </span>
          <span class="purchase-option__content">
            <span class="purchase-option__title">
              {{ 'products.product.subscribe_save' | t | default: 'Subscribe & Save' }}
              <span class="purchase-option__badge">
                {%- assign discount_percentage = settings.subscription_discount | default: 15 -%}
                {{ 'products.product.save_percentage' | t: percentage: discount_percentage | default: 'Save 15%' }}
              </span>
            </span>
            <span class="purchase-option__price" data-subscribe-price>
              {%- if selected_variant -%}
                {%- assign discounted_price = selected_variant.price | times: 0.85 -%}
                {{ discounted_price | money }}
              {%- else -%}
                {%- assign discounted_price = product.price | times: 0.85 -%}
                {{ discounted_price | money }}
              {%- endif -%}
              <span class="purchase-option__frequency">{{ 'products.product.delivery_frequency' | t | default: 'Delivered every 30 days' }}</span>
            </span>
          </span>
        </span>
      </label>
    </div>
  </div>

  {%- comment -%} Subscription details (shown when subscribe is selected) {%- endcomment -%}
  <div class="purchase-options__details" data-subscription-details style="display: none;">
    <div class="subscription-frequency">
      <label for="subscription-frequency-{{ section.id }}" class="subscription-frequency__label">
        {{ 'products.product.delivery_every' | t | default: 'Deliver every' }}
      </label>
      <select 
        id="subscription-frequency-{{ section.id }}" 
        name="subscription_frequency" 
        class="subscription-frequency__select"
        data-subscription-frequency
      >
        <option value="15">{{ 'products.product.frequency_15_days' | t | default: '15 days' }}</option>
        <option value="30" selected>{{ 'products.product.frequency_30_days' | t | default: '30 days' }}</option>
        <option value="45">{{ 'products.product.frequency_45_days' | t | default: '45 days' }}</option>
        <option value="60">{{ 'products.product.frequency_60_days' | t | default: '60 days' }}</option>
        <option value="90">{{ 'products.product.frequency_90_days' | t | default: '90 days' }}</option>
      </select>
    </div>
    
    <div class="subscription-benefits">
      <ul class="subscription-benefits__list">
        <li class="subscription-benefits__item">
          <svg class="subscription-benefits__icon" width="16" height="16" viewBox="0 0 16 16" fill="none">
            <path d="M13.5 4.5L6 12L2.5 8.5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          {{ 'products.product.free_shipping' | t | default: 'Free shipping on all orders' }}
        </li>
        <li class="subscription-benefits__item">
          <svg class="subscription-benefits__icon" width="16" height="16" viewBox="0 0 16 16" fill="none">
            <path d="M13.5 4.5L6 12L2.5 8.5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          {{ 'products.product.cancel_anytime' | t | default: 'Cancel or pause anytime' }}
        </li>
        <li class="subscription-benefits__item">
          <svg class="subscription-benefits__icon" width="16" height="16" viewBox="0 0 16 16" fill="none">
            <path d="M13.5 4.5L6 12L2.5 8.5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
          {{ 'products.product.exclusive_offers' | t | default: 'Exclusive subscriber-only offers' }}
        </li>
      </ul>
    </div>
  </div>

  {%- comment -%} Hidden inputs for CheckoutChamp integration {%- endcomment -%}
  <input type="hidden" name="subscription_enabled" value="false" data-subscription-enabled>
  <input type="hidden" name="subscription_discount" value="{{ settings.subscription_discount | default: 15 }}">
</div>